<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stellar Multi-Tool</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg:#0b0f12;
      --panel:#0f1720;
      --muted:#94a3b8;
      --accent:#9333ea;
      --accent-2:#06b6d4;
    }
    body { background:var(--bg); font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial; color:#e6eef6 }
    .card { background:var(--panel); border:1px solid #1f2937; border-radius:12px; padding:1.25rem; }
    .muted { color:var(--muted) }
  </style>
</head>
<body class="min-h-screen">

  <!-- header -->
  <header class="w-full border-b border-slate-800">
    <div class="max-w-6xl mx-auto px-6 py-5 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-md bg-gradient-to-br from-[var(--accent)] to-[var(--accent-2)] flex items-center justify-center font-bold text-black">SM</div>
        <div>
          <h1 class="text-lg font-semibold">Stellar Multi-Tool</h1>
          <p class="text-xs muted -mt-0.5">OSINT & Info Tools</p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <a href="/dashboard.html" id="dashboardLink" class="px-4 py-2 rounded-md bg-[var(--panel)] text-sm border border-slate-800 hover:brightness-105">Dashboard</a>
        <button id="accessBtn" class="px-4 py-2 rounded-md bg-gradient-to-r from-[var(--accent)] to-[var(--accent-2)] text-black font-semibold">Access</button>
      </div>
    </div>
  </header>

  <!-- main -->
  <main class="max-w-6xl mx-auto px-6 py-12 space-y-8">
    <section class="grid md:grid-cols-2 gap-8 items-center">
      <div>
        <h2 class="text-4xl font-extrabold leading-tight">Stellar Multi-Tool</h2>
        <p class="muted mt-3">A lightweight OSINT toolkit with Breach Checker, Phone Lookup, Social Lookup, IP Info, DNS Lookup, Joke, UUID and more. Keys required to use tools ‚Äî simple free trial keys supported.</p>
        <div class="mt-6 flex gap-3">
          <a class="px-5 py-3 rounded-md bg-[var(--accent)] font-semibold text-black shadow" href="/dashboard.html">Go to Dashboard</a>
        </div>
      </div>

      <div class="card">
        <h3 class="text-xl font-bold mb-2">Available Tools</h3>
        <ul class="mt-3 space-y-2">
          <li class="flex items-start gap-3"><strong>üîí Breach Checker</strong><span class="muted ml-2">Email breach lookups (key required)</span></li>
          <li class="flex items-start gap-3"><strong>üì± Phone Lookup</strong><span class="muted ml-2">Carrier & validation (key required)</span></li>
          <li class="flex items-start gap-3"><strong>üåê Social Lookup</strong><span class="muted ml-2">Check username existence across sites (key required)</span></li>
          <li class="flex items-start gap-3"><strong>üåç IP Info</strong><span class="muted ml-2">ipapi.co</span></li>
          <li class="flex items-start gap-3"><strong>üîé DNS Lookup</strong><span class="muted ml-2">dns.google</span></li>
          <li class="flex items-start gap-3"><strong>üòÇ Random Joke</strong><span class="muted ml-2">jokeapi</span></li>
          <li class="flex items-start gap-3"><strong>üÜî UUID Generator</strong><span class="muted ml-2">Local generator</span></li>
        </ul>
        <p class="muted text-xs mt-4">Note: Tools that require external APIs use serverless API routes so your keys remain hidden.</p>
      </div>
    </section>

    <section class="card">
      <h3 class="text-lg font-bold">How access works</h3>
      <ol class="mt-3 list-decimal ml-5 muted">
        <li>Click <strong>Access</strong> (top-right) to enter a 16-digit numeric key (format: 4-4-4-4 digits) or generate one.</li>
        <li>Generated keys are unique and stored in the server database (Upstash recommended).</li>
        <li>After logging in you'll be sent to your dashboard with usage stats and chat.</li>
      </ol>
    </section>

  </main>

  <!-- Access Modal -->
  <div id="accessModal" class="fixed inset-0 hidden items-center justify-center bg-black/70 z-50">
    <div class="bg-[var(--panel)] rounded-xl p-6 w-[420px]">
      <h3 class="text-xl font-bold mb-2">Account Access</h3>
      <p class="muted text-sm mb-4">Enter your 16-digit numeric account key (format: 1234-5678-9012-3456).</p>

      <div class="flex gap-2 mb-3">
        <input id="keyPart1" maxlength="4" class="input-part w-20 p-2 bg-[#0b1114] rounded" />
        <input id="keyPart2" maxlength="4" class="input-part w-20 p-2 bg-[#0b1114] rounded" />
        <input id="keyPart3" maxlength="4" class="input-part w-20 p-2 bg-[#0b1114] rounded" />
        <input id="keyPart4" maxlength="4" class="input-part w-20 p-2 bg-[#0b1114] rounded" />
      </div>

      <div class="flex gap-3">
        <button id="generateKeyBtn" class="px-4 py-2 bg-green-600 rounded font-semibold">Generate An Account Key</button>
        <button id="loginKeyBtn" class="px-4 py-2 bg-[var(--accent)] rounded font-semibold text-black">Log In</button>
        <button id="closeModal" class="ml-auto px-3 py-2 bg-gray-700 rounded">Close</button>
      </div>

      <p id="accessMsg" class="muted text-sm mt-3"></p>
    </div>
  </div>

  <script>
    // small helpers & UI
    const accessBtn = document.getElementById('accessBtn');
    const accessModal = document.getElementById('accessModal');
    const closeModal = document.getElementById('closeModal');
    const generateKeyBtn = document.getElementById('generateKeyBtn');
    const loginKeyBtn = document.getElementById('loginKeyBtn');
    const accessMsg = document.getElementById('accessMsg');

    accessBtn.addEventListener('click', () => accessModal.classList.remove('hidden'));
    closeModal.addEventListener('click', () => accessModal.classList.add('hidden'));

    function readKeyFromInputs() {
      const p1 = document.getElementById('keyPart1').value.trim();
      const p2 = document.getElementById('keyPart2').value.trim();
      const p3 = document.getElementById('keyPart3').value.trim();
      const p4 = document.getElementById('keyPart4').value.trim();
      return `${p1}-${p2}-${p3}-${p4}`;
    }

    async function generateUniqueKey() {
      accessMsg.textContent = 'Generating...';
      const res = await fetch('/api/auth/generate-key', { method:'POST' });
      const json = await res.json();
      if (json.key) {
        const parts = json.key.split('-');
        document.getElementById('keyPart1').value = parts[0];
        document.getElementById('keyPart2').value = parts[1];
        document.getElementById('keyPart3').value = parts[2];
        document.getElementById('keyPart4').value = parts[3];
        accessMsg.textContent = 'Key generated ‚Äî press Log In to use it.';
      } else {
        accessMsg.textContent = 'Failed to generate key.';
      }
    }

    generateKeyBtn.addEventListener('click', generateUniqueKey);

    loginKeyBtn.addEventListener('click', async () => {
      accessMsg.textContent = 'Verifying key...';
      const key = readKeyFromInputs();
      const res = await fetch('/api/auth/login?key=' + encodeURIComponent(key));
      const json = await res.json();
      if (res.ok && json.valid) {
        // store locally and redirect to dashboard
        localStorage.setItem('stellar_key', json.key);
        window.location.href = '/dashboard.html';
      } else {
        accessMsg.textContent = json.error || 'Invalid key';
      }
    });

    // auto-fill dashboard link if logged in
    const storedKey = localStorage.getItem('stellar_key');
    if (storedKey) {
      document.getElementById('dashboardLink').href = '/dashboard.html';
    }
  </script>

  <style>
    .input-part { text-align:center; font-weight:600; color:#e6eef6; border:1px solid #21303a }
  </style>
</body>
</html>
